<div class="poll main-box">
    <!-- If not authorized yet -->
    <app-auth-required *ngIf="!loggedIn"></app-auth-required>

    <!-- While still waiting for server -->
    <h2 *ngIf="!poll && !error && loggedIn">Loading...</h2>

    <!-- If an error has occured -->
    <h2 *ngIf="error">Error: {{error}}</h2>

    <!-- Main content -->
    <span *ngIf="poll">
        <h2>{{poll.name}}</h2>
        <p *ngIf="poll.description" class="desc">{{poll.description}}</p>

        <!-- Option list for those unable to vote. -->
        <app-nonvoter
            *ngIf="!poll.can_vote && !poll.finished"
            [options]="poll.options"
            [choice]="poll.choice"
            [method]="poll.method">
        </app-nonvoter>

        <!-- Option list for finished polls -->
        <app-results
            *ngIf="poll.finished"
            [results]="poll.results"
            [method]="poll.method"
            [options]="poll.options">
        </app-results>

        <!-- Option list for First Past the Post voters -->
        <app-single-choice
            *ngIf="poll.can_vote && poll.method=='fptp'"
            [options]="poll.options"
            (vote)="vote($event)">
        </app-single-choice>

        <!-- Option list for Instant Runoff voters -->
        <app-ranked-choice
            *ngIf="poll.can_vote && poll.method=='irv'"
            [options]="poll.options"
            (vote)="vote($event)">
        </app-ranked-choice>

        <!-- Option list for Approval voters -->
        <app-binary-score-choice
            *ngIf="poll.can_vote && poll.method=='approval'"
            [options]="poll.options"
            (vote)="vote($event)">
        </app-binary-score-choice>

        <!-- Owner options -->
        <app-owner-options
            *ngIf="poll.own"
            (conclude)="finishPoll()"
            (delete)="deletePoll()"
            [finished]="poll.finished">
        </app-owner-options>
    </span>

</div>
